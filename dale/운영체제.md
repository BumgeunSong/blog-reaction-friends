## 운영체제

- 운영체제 ?

	- 하드웨어와 소프트웨어가 통신할 수 있도록 하는 소프트웨어 프로그램

- 목적

	- 컴퓨터의 계산 활동을 관리하여 시스템이 제대로 작동하도록 함

	- 프로그램 개발 및 실행을 위한 환경 제공

### 메모리

- 메모리 ? 

	- 컴퓨터에서 작업을 수행하기 위해 처리 대상이나 결과 등을 저장하기 위한 공간

	- 프로그램을 실행하기 위한 정보들은 메모리에 저장되어 처리

- 코드

	- 실행할 프로그램의 코드가 저장되는 텍스트 영역

	- CPU는 저장된 명령어를 하나씩 가져가며 처리

- 데이터

	- 전역변수와 정적변수를 저장하는 영역

	- 프로그램 시작과 함께 할당, 종료되면 소멸

- 스택

	- 함수의 호출과 관계되는 지역변수와 매개변수가 저장되는 영역

	- 함수의 호출과 함께 할당, 종료되면 해제

- 힙

	- 사용자가 직접 관리할수 있는 메모리 영역

	- 사용자에 의해 메모리공간이 동적으로 할당되고 해제

### 프로세스

- 프로세스 ?

	- 컴퓨터에서 실행되고 있는 프로그램

	- 운영체제 프로세스

	- 사용자 프로세스

- 특징

	- 독립된 메모리 영역을 할당받는다.

	- 최소 1개의 스레드를 가지고있다.

	- 별도의 주소 공간에서 실행, 다른 프로세스의 변수나 자료구조에 접근할 수 없다.

	- 다른프로세스의 자원에 접근하려면 프로세스 간의 통신을 사용해야 함 (IPC)

		- IPC ?

### 스레드

- 스레드 ?

	- CPU 사용의 기본 단위

	- ID, 프로그램 카운터, 레지스터 세트, 스택 으로 구성

- 특징

	- 프로세스 내에서 Stack만 할당받고 Code, Data, Heap 영역 공유

	- 프로세스 내의 자원을, 같은 프로세스 내의 스레드끼리 공유

	- 각각의 스레드는 별도의 레지스터와 스택을 갖고 있지만, 힙 메모리는 서로 읽고 쓸 수 있다.

	- 하나 스레드가 프로세스 자원을 변경하면 다른 이웃 스레드도 그 결과를 즉시 공유

- 멀티 스레딩

	- 장점

		- 하나의 프로세스 내에서 다수의 실행 단위들이 존재하여 작업의 수행에 필요한 자원들을 공유하기 때문에 자원의 생성과 관리가 중복되는 것을 줄일 수 있다.

	- 단점

		- 교착상태

			- 한정된 자원을 여러 프로세스가 사용하고자 할 때 발생하는 상황

			- 프로세스가 자원을 얻기 위해 영구적으로 기다리는 상태

			- 조건

				- 상호배제 (Mutual Exclusion)

				- 점유와 대기(Hold and Wait)

				- 비선점(Non preemprive)

				- 환형 대기(Circle wait)

			- 해결 방법

				- 예방

					- 교착상태가 발생하지 않도록 하는것

				- 회피

					- 교착상태를 피하는것

					- Banker's algorithm

					  - 프로세스가 데이터를 요구할 때 시스템은 데이터를 할당한 후에도 안정 상태로 남아있게 되는지를 사전에 검사하여 회피

				- 탐지

					- 발생 -> 탐지 -> 복구

				- 복구

					- 프로세스 중지, 자원선점 (희생자 선택 -> 기아, 복귀)

		- 동기화

### 기아

- 특정 프로세스의 우선순위가 낮아서 원하는 데이터를 할당 받지 못하는 상태

- 대기중인 프로세스는 데이터가 다른 프로세스에 할당되어 있기 때문에 오랫동안 필요한 리소스를 얻지 못함

### 에이징

- 데이터 스케쥴링 시스템에서 기아를 방지하기 위해 사용되는 기술

- 특정 프로세스의 우선순위가 낮아 계속적으로 기다리게 되는 경우, 양보 및 기다린 시간에 비례하여 우선순위를 한 단계씩 높여 가까운 시간 안에 데이터를 할당받도록 하는 기법

### 세마포어

- Signaling메커니즘

- 공유 데이터에 접근할 수 있는 프로세스의 최대 허용치만큼 동시에 사용자가 접근하여 사용가능

### 뮤텍스

- Locking 메커니즘

- 여러 스레드의 Running Time이 서로 겹치지 않도록 각각 단독으로 실행하게 하여 사용

- Lock을 걸은 스레드만 Lock을 해제할 수 있음.

### 페이징

- 페이징?

    - 논리주소의 고정된 페이지라고 불리는 블록들로 분할 관리하는 기법

    - 각각의 페이지는 물리메모리의 프레임과 맵핑

    - 페이지를 가리키는 논주소에서 프레임을 가리키는 물리주소로 변환

- 장점

    - 불연속적인 메모리 요청 등에 유연하게 처리 가능

    - 외부단편화가 발생하지 않음

- 단점

    - 내부단편화가 발생할 수 있음

    - 페이지 크기별, 단위별로 페이지 폴트 현상 발생 가능

### 동기 / 비동기

- Sync

    - 요청 -> 결과 -> 다음작업

    - 직관적

    - 처리중 다른작업 처리불가능

    - 작업완료 여부를 호출한 쪽에서 신경

- Async

    - 요청을 보낸순서대로 결과가 오지않음

    - sync보다 복잡하지만, 효율적

    - 작업완료 여부를 호출된 쪽에서 신경

### CPU Scheduling

- CPU Scheduling?

    - 어떤 프로세스가 CPU를 사용할 수 있게 하는지 결정하는 정책

- 발생 ?

    - 실행상태 -> 대기상태

        - Non preemptive(비선점)

        - ex) 입출력 요청

    - 실행상태 -> 준비상태

        - preemptive(선점)

        - ex) 인터럽트 발생

    - 대기상태 -> 준비상태

        - ex) 입출력 종료

    - 종료

- 종류

    - Non-preemptive (비선점)

        - 특징

            - 이미 할당된 CPU를 다른 프로세스가 강제로 빼앗아 사용할 수 없는 스케쥴링 기법

            - 프로세스가 CPU 할당을 받으면 해당 프로세스가 완료될 때까지 CPU를 사용

            - 일괄 처리 방식의 스케쥴링

            - 긴급 응답을 요구하는 작업에는 x

        - 기법

            - FCFS(FIFO)

                - 준비상태 큐에 도착한 순서에 따라 CPU 할당

                - 장점

                    - 평균 응답시간이 길다.

                - 단점

                    - 도착 순서에 따르기 때문에 공평

            - SJF(Shortest Job First)

                - 실행시간이 가장 짧은 프로세스에 먼저 CPU를 할당하는 기법

                - 장점

                    - 평균 응답시간이 최소

                - 단점

                    - 실행시간이 긴 프로세스는 무한히 대기하는 기아 현상 발생

            - HRN(Highest Response Ratio)

                - SJF 보완, 우선순위 계산 결과 값이 높은 것부터 우선순위 부여

                - 대기시간이 길수록 계산결과 높음

            - 기한부(DeadLine)

                - 프로세스에게 일정한 시간을 주어 그 시간 안에 프로세스를 완료하도록 하는 기법

            - 우선순위(Priority)

                - 준비상태 큐에서 기다리는 각 프로세스마다 우선순위를 부여하여 그 중 가장 높은 프로세스에게 먼저 CPU를 할당

    - Preemptive (선점)

        - 특징

            - 하나의 프로세스가 CPU를 할당받아 실행 하고 있을 때 우선순위가 높은 프로세스가 CPU를 빼앗아 사용할 수 있는 스케쥴링 기법

            - 선점으로 인한 많은 오버헤드 발생

            - 시분할 시스템에 사용하는 스케쥴링

            - 선점을 위해 시간 배당을 위한 인터럽트용 타이머 클럭이 필요

        - 기법

            - SRT(Shortest Remaining Time)

                - 현재 실행 중인 프로세스의 남은 시간과 대기 큐 프로세스의 실행시간이 가장 짧은 프로세스에게 CPU를 할당하는 기법

                - 단점

                    - 잦은 선점으로 인한 문맥교환의 부담

                    - 기아 위험

            - 선점 우선순위

                - 준비상태 큐의 프로세스들 중에서 우선순위가 가장 높은 프로세스에게 먼저 CPU 할당

            - RR(Round Robin)

                - FCFS 알고리즘을 선점 형태로 변형하여 대기 큐에서 먼저 대기한 작업이 먼저 CPU를 사용

                - 단점

                    - CPU를 사용할 수 있는 시간동안 CPU를 사용한 후에 다시 대기큐의 끝으로 배치

                    - 할당 시간이 클경우 FCFS와 같아짐

                    - 할당 시간이 작을 경우 문맥교환, 오버헤드 자주 발생

            - MLQ(다단계 큐)

                - 프로세스를 특정 그룹으로 분류 할 수 있는 경우 그룹에 따라 각기 다른 준비상태 큐 사용

                - 상위 우선순위의 큐가 Empty이면 하위 우선순위 프로세스 실행

            - MLFQ(다단계 피드백 큐)

                - 다단계 큐에서 특정 그룹의 준비상태 큐에 들어간 프로세스가 다른 준비상태 큐로 이동할 수 있도록 개선한 기법

                - 새로운 프로세스는 높은 우선순위, 프로세스의 실행이 길어질 수록 점점 낮은 우선순위큐로 이동 마지막 단계에서는 RR/FCFS 처리

                - 기아를 예방하는 Aging 방법.

                - RR방식과 함께 가장 많이 사용되는 스케쥴링 기법

            - RM(Rate Monotonic, 주기단조)

                - 수행주기가 가장 짧은 프로세스에 가장 높은 우선순위를 부여하는 기법

                - 장점

                    - 간편함

                - 단점

                    - 주기가 긴 태스크가 장시간 대기

            - EDF(Earliest Deadline First, 최단 마감시간 우선)

                - 프로세스의 마감이 가까울수록 우선순위를 높게 부여

                - 단점

                    - 수행시간, 마감시간, 주기등을 정확히 예측하는것이 현실적으로 어려움

### 프로세스 vs 스레드

- 프로세스는 운영체제로부터 메모리, 주소 등을 할당받고 쓰레드는 할당받은 자원들을 내부 스레드끼리 공유하면서 실행

- 프로세스

    - 운영체제로부터 자원을 할당받는 작업의 단위

- 스레드

    - 프로세스가 할당받는 자원을 이용하는 실행의 단위

### 세마포어 vs 뮤텍스

- 동기화 대상의 갯수

    - 뮤텍스? 

        - 1개

    - 세마포어?

        - 1개 이상

